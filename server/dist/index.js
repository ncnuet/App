(()=>{"use strict";var e={4742:(e,t)=>{function n(){return Object.assign({},t.cookieSecureOption)}Object.defineProperty(t,"__esModule",{value:!0}),t.withSession=t.withAge=t.cookieSecureOption=void 0,t.cookieSecureOption={httpOnly:!0,secure:!0},t.withAge=function(e){return void 0===e?n():Object.assign(Object.assign({},t.cookieSecureOption),{maxAge:e})},t.withSession=n},2009:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.connect=void 0;const o=i(n(1185)),a=i(n(5343)),{MG_HOST:s,MG_PORT:c,MG_NAME:u,MG_USERNAME:d,MG_PASSWORD:l,MONGODB_URI:f}=a.default;o.default.set("strictQuery",!0);const p=f||`mongodb+srv://${d}:${l}@${s}/${u}?retryWrites=true&w=majority`;t.connect=()=>r(void 0,void 0,void 0,(function*(){return o.default.connect(p,{})}))},5343:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const o=n(5142),a=i(n(1017)),s=process.env,{NODE_ENV:c}=s,u=r(s,["NODE_ENV"])||{},d=(0,o.config)("dev"===c?{path:a.default.resolve(process.cwd(),".env.dev")}:void 0).parsed;t.env="production",t.default=Object.assign(Object.assign(Object.assign({},d),{ENV:"production"}),u)},1633:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.JWTResetOpt=t.JWTRefreshOpt=t.JWTTokenOpt=void 0;const i=r(n(5343));t.JWTTokenOpt={expiresIn:"dev"===i.default.ENV?"10s":"3600s"},t.JWTRefreshOpt={expiresIn:"dev"===i.default.ENV?"3600s":"86400s"},t.JWTResetOpt={expiresIn:"dev"===i.default.ENV?"180s":"300s"}},6168:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(5184)),c=a(n(5343)),u=s.createTransport({pool:!0,service:c.default.MAIL_SERVICE,auth:{user:c.default.MAIL_USER,pass:c.default.MAIL_PASSWORD}});t.default=u},9818:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startup=t.setupRedisIndex=t.redis=void 0;const o=n(7773),a=i(n(5343)),s=n(9372);function c(){return r(this,void 0,void 0,(function*(){yield(0,s.setTokenIndex)()}))}t.redis=(0,o.createClient)({password:a.default.RD_PASSWORD,username:a.default.RD_USERNAME,socket:{host:a.default.RD_HOST,port:Number(a.default.RD_PORT)}}),t.setupRedisIndex=c,t.startup=function(){return r(this,void 0,void 0,(function*(){yield t.redis.connect(),yield c()}))}},6464:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(4742),a=n(7797),s=i(n(8849)),c=i(n(4747)),u=i(n(5215)),d=i(n(4947)),l=n(3713),f=i(n(5343));t.default=class{static login(e,t){return r(this,void 0,void 0,(function*(){const n=e.body;console.log(n),yield(0,s.default)(t,(()=>r(this,void 0,void 0,(function*(){c.default.validateLoginPassword(n);const e=yield u.default.findUserByPassword(n.username,n.password);if(e){const r=(yield d.default.getVersion(e.uid))||"0",i=(0,a.generateToken)(Object.assign(Object.assign({},e),{version:r,remember:n.remember}),!0);yield d.default.insertRefreshToken(i.refreshToken,e.uid,e.role),function(e,t,n,r){r&&e.cookie("refresh_token",r,(0,o.withAge)(864e5)),e.status(200).cookie("token",n,(0,o.withAge)(t?36e5:void 0)).json({message:"success",data:{accessToken:n,refreshToken:r}}).send()}(t,n.remember,i.accessToken,i.refreshToken)}else t.status(401).json({message:"Tài khoản hoặc mật khẩu không chính xác",name:"password"})}))))}))}static logout(e,t){return r(this,void 0,void 0,(function*(){const e=t.locals.user;yield(0,s.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.deleteRefreshToken(e.uid),d.default.updateVersion(e.uid),t.cookie("token",null,(0,o.withAge)(0)),t.cookie("refresh_token",null,(0,o.withAge)(0)),t.sendStatus(200)}))))}))}static requestReset(e,t){return r(this,void 0,void 0,(function*(){const n=e.body;console.log(n),yield(0,s.default)(t,(()=>r(this,void 0,void 0,(function*(){c.default.validateRequestReset(n);const e=yield u.default.findUserByInfo(n);if(e){const{username:n,uid:r}=e,i=(0,a.generateResetToken)({username:n,uid:r,name:"",role:"admin",version:"0",remember:!1,office:""});yield(0,l.sendForgetPasswordMail)(e,i),t.status(200).json({message:"Email đã được gửi thành công tới "+e.email})}else t.status(400).json({message:"Không tồn tại email",name:"email"})}))))}))}static verifyReset(e,t){return r(this,void 0,void 0,(function*(){const n=t.locals.user.username,r=1e3*t.locals.user.exp,i=Math.floor((r-(new Date).getTime())/1e3);t.cookie("token",e.query.token,(0,o.withAge)(18e4)).redirect(f.default.FRONTEND+"/resetpassword?ttl="+i+"&user="+n)}))}static resetPassword(e,t){return r(this,void 0,void 0,(function*(){const n=e.body;yield(0,s.default)(t,(()=>r(this,void 0,void 0,(function*(){c.default.validateReset(n);const e=t.locals.user;yield u.default.updatePassword(e.uid,n.password),t.json({message:"Password changed successfully"})}))))}))}}},3639:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7515)),a=i(n(5805)),s=n(5417),c=n(1468),u=i(n(8849)),d=i(n(2332));class l{static precheck(e){return r(this,void 0,void 0,(function*(){if(e.manager){const t=yield a.default.getUsers([e.manager]);if(0===t.length)throw new s.InputError("Manager id not found","manager");if("head"!==t[0].role)throw new s.InputError("User role must be head","role")}if(e.gather_office){const t=yield o.default.getOffices([e.gather_office]);if(0===t.length)throw new s.InputError("Office id not found","gather_office");if(t[0].office_type!==c.EOfficeType.Gathering)throw new s.InputError("Office type must be gathering","gather_office_type")}}))}static create(e,t){return r(this,void 0,void 0,(function*(){const n=e.body;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateCreate(n),yield l.precheck(n);const e=yield o.default.create(n);t.json({message:"Created success",data:{id:e}})}))))}))}static delete(e,t){return r(this,void 0,void 0,(function*(){const n=e.params.id;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateDelete({id:n});const e=yield o.default.delete(n);t.json({message:e?"Created success":"Unable to delete",data:{id:n}})}))))}))}static update(e,t){return r(this,void 0,void 0,(function*(){const n=e.params.id,i=e.body;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateUpdate(Object.assign({id:n},i)),yield l.precheck(i);const e=yield o.default.update(n,i);t.json({message:e?"Updated success":"Unable to update",data:{id:n}})}))))}))}}t.default=l},314:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(7515)),a=i(n(2523)),s=i(n(1066)),c=n(5417),u=i(n(8849)),d=i(n(2750));class l{static precheck(e){return r(this,void 0,void 0,(function*(){if(e.receiving_office&&0===(yield o.default.getOffices([e.receiving_office])).length)throw new c.InputError("Invalid office id","receiving_office")}))}static create(e,t){return r(this,void 0,void 0,(function*(){const n=e.body,i=t.locals.user,o=Object.assign(Object.assign({},n),{creator:i.uid,sending_office:i.office});(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateCreate(o),yield l.precheck(o);const e=yield a.default.create(o),n=yield s.default.create({parcel:e,office:i.office,uid:i.uid});t.status(200).json({message:"Created successfully",data:{parcel_id:e,tracking_id:n}})}))))}))}static delete(e,t){return r(this,void 0,void 0,(function*(){const n=e.params.id,i=t.locals.user;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateDelete({id:n});const e=yield a.default.delete(n,i.office);t.json({message:e?"Deleted successfully":"Unable to delete",data:{id:n}})}))))}))}static update(e,t){return r(this,void 0,void 0,(function*(){const n=e.params.id,i=e.body,o=t.locals.user;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateUpdate(Object.assign({id:n},i)),yield l.precheck(i);const e=yield a.default.update(n,o.office,i);t.json({message:e?"Updated successfully":"Unable to update",data:{id:n}})}))))}))}static updateStatus(e,t){return r(this,void 0,void 0,(function*(){const n=e.params.id,i=e.body,o=t.locals.user;(0,u.default)(t,(()=>r(this,void 0,void 0,(function*(){d.default.validateUpdateStatus(Object.assign({id:n},i));const e=yield s.default.push(n,Object.assign(Object.assign({},i),{uid:o.uid,office:o.office})),r=yield a.default.updateStatus(n,i);t.json({message:r&&e?"Updated status successfully":"Unable to update status",data:{id:n}})}))))}))}}t.default=l},6305:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(5215)),a=i(n(4947));t.default=new class{getStatus(e,t){t.json({message:"OK"})}getUser(e,t){return r(this,void 0,void 0,(function*(){const n=e.body;console.log(n);const r=yield o.default.findUserByPassword(n.username,n.password);console.log(r),r?t.json({message:"hello",data:r}):t.json({message:"error",data:{}})}))}addToken(e,t){return r(this,void 0,void 0,(function*(){yield a.default.insertRefreshToken("sdcasdcasdcasdc","21020365","admin"),t.json({message:"OK"})}))}}},3607:function(e,t,n){e=n.nmd(e);var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const c=s(n(6860)),u=s(n(7806)),d=s(n(9470)),l=s(n(9710)),f=s(n(8479)),p=o(n(5343)),h=o(n(3582)),v=o(n(2009)),y=o(n(9818)),_=(0,c.default)(),m=p.default.PORT;_.use((0,d.default)("dev"===p.env?"dev":"tiny")),_.use(c.default.json()),_.use(c.default.urlencoded({extended:!0})),_.use((0,l.default)()),_.use((0,u.default)()),_.use(h.default({origin:p.default.FRONTEND,credentials:!0,methods:["GET","PUT","POST","DELETE"],optionsSuccessStatus:200,allowedHeaders:["Content-Type, Authorization"]})),(0,f.default)(_),n.c[n.s]===e&&_.listen(m,(()=>a(void 0,void 0,void 0,(function*(){yield y.startup(),console.log("📕 [redis]: Connected to redis"),yield v.connect(),console.log("📒 [mongo]: Connected to mongo"),console.log(`✅ [server]: Server is running at http://localhost:${m}`)})))),t.default=_},322:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkJWT=void 0;const c=o(n(9344)),u=s(n(5343)),d=n(5326),l=s(n(4947));t.checkJWT=function(e,t,n){return a(this,void 0,void 0,(function*(){const r=this&&"query"===this.tokenOn?e.query.token:e.cookies.token;if(!r)return t.sendStatus(401);try{const e=c.verify(r,u.default.JWT_KEY),i=yield l.default.getVersion(e.uid);if(i&&i!==e.version)return t.sendStatus(401);t.locals.user=e,n()}catch(r){if(!(r instanceof c.TokenExpiredError))return console.log(r),t.sendStatus(401);(0,d.checkRWT)(e,t,n)}}))}},5326:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkRWT=void 0;const c=o(n(9344)),u=s(n(5343)),d=n(7797),l=s(n(4947)),f=n(4742),p=s(n(8849));t.checkRWT=function(e,t,n){return a(this,void 0,void 0,(function*(){const r=e.cookies.refresh_token;(0,p.default)(t,(()=>a(this,void 0,void 0,(function*(){if(!r||!(yield l.default.getRefreshToken(r)))return t.sendStatus(401);try{const e=c.verify(r,u.default.JWT_REFRESH_KEY);e.role=yield l.default.getRole(e.uid),e.version=yield l.default.getVersion(e.uid);const i=(0,d.generateToken)(e,!0);yield l.default.insertRefreshToken(i.refreshToken,e.uid,e.role),t.cookie("refresh_token",i.refreshToken,(0,f.withAge)(864e5)).cookie("token",i.accessToken,(0,f.withAge)(e.remember?36e5:void 0)).locals.user=e,n()}catch(e){console.log(e),t.sendStatus(401)}}))))}))}},6990:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkReset=void 0;const s=o(n(9344)),c=a(n(5343));t.checkReset=function(e,t,n){const r=e.query.token||e.cookies.token;if(!r)return t.sendStatus(401);try{const e=s.verify(r,c.default.JWT_RESET_KEY);t.locals.user=e,n()}catch(e){return console.log(e),t.sendStatus(401)}}},944:function(e,t){var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.checkRole=void 0,t.checkRole=function(e,t,r){return n(this,void 0,void 0,(function*(){const{role:e}=t.locals.user;if(!e||!this.role.includes(e))return t.sendStatus(401);r()}))}},5215:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=o(n(8432)),c=n(6820);t.default=new class{findUserByPassword(e,t){return a(this,void 0,void 0,(function*(){const n=yield c.UserBaseModel.findOne({username:e},{_id:1,role:1,username:1,password:1,office:1,name:1}).exec();if(!n)return;const{_id:r,username:i,password:o,role:a,office:u,name:d}=n;return t?(yield s.compare(t,o))&&{uid:r.toString(),office:u.toString(),username:i,role:a,name:d}:void 0}))}findUserByInfo(e){return a(this,void 0,void 0,(function*(){const t=yield c.UserBaseModel.findOne({$or:[{username:e.username},{email:e.email},{phone:e.phone},{uid:e.uid}]},{email:!0,username:!0,phone:!0,_id:!0}).exec();if(!t)return;const{username:n,phone:r,_id:i,email:o,office:a}=t;return{username:n,phone:r,uid:i,email:o}}))}updatePassword(e,t){return a(this,void 0,void 0,(function*(){c.UserBaseModel.updateOne({_id:e},{password:yield s.hash(t,10)}).exec()}))}}},9468:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OfficeBaseModel=void 0;const r=n(1185),i=n(1468);t.OfficeBaseModel=(0,r.model)("Office",i.officeSchema)},9656:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ParcelBaseModel=void 0;const i=n(1185),o=r(n(7181));t.ParcelBaseModel=(0,i.model)("Parcel",o.default)},6899:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TrackingBaseModel=void 0;const r=n(1185),i=n(9716);t.TrackingBaseModel=(0,r.model)("Tracking",i.trackingSchema)},6820:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UserBaseModel=void 0;const r=n(1185),i=n(5102);t.UserBaseModel=(0,r.model)("User",i.userSchema)},7515:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9468),o=n(6203);t.default=new class{create(e){return r(this,void 0,void 0,(function*(){const t=(0,o.resolveAddress)(e.address);return(yield i.OfficeBaseModel.create({name:e.name,address:t,manager:e.manager,contact:e.contact,office_type:e.office_type,gather_office:e.gather_office}))._id}))}update(e,t){return r(this,void 0,void 0,(function*(){const n=(0,o.resolveAddress)(t.address);return(yield i.OfficeBaseModel.updateOne({_id:e},{name:t.name,address:n,manager:t.manager,contact:t.contact,office_type:t.office_type,gather_office:t.gather_office})).acknowledged}))}delete(e){return r(this,void 0,void 0,(function*(){return(yield i.OfficeBaseModel.deleteOne({_id:e})).acknowledged}))}getOffices(e){return r(this,void 0,void 0,(function*(){return(yield i.OfficeBaseModel.find({_id:{$in:e}}).exec()).map((e=>{const{_id:t,name:n,address:r,contact:i,office_type:o,manager:a,gather_office:s}=e;return{name:n,address:r,contact:i,office_type:o,poid:t.toString(),manager:a?a.toString():null,gather_office:s?s.toString():null}}))}))}}},2523:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9656),o=n(6203);t.default=new class{create(e){return r(this,void 0,void 0,(function*(){return(yield i.ParcelBaseModel.create({sending_add:(0,o.resolveAddress)(e.sending_add),receiving_add:(0,o.resolveAddress)(e.receiving_add),sender:e.sender,receiver:e.receiver,sending_office:e.sending_office,receiving_office:e.receiving_office,status:e.status,goods:e.goods,notes:e.notes,return_type:e.return_type,cost_type:e.cost_type,cost:e.cost,goods_type:e.goods_type,creator:e.creator}))._id}))}update(e,t,n){return r(this,void 0,void 0,(function*(){return(yield i.ParcelBaseModel.updateOne({_id:e,sending_office:t},{sending_add:(0,o.resolveAddress)(n.sending_add),receiving_add:(0,o.resolveAddress)(n.receiving_add),sender:n.sender,receiver:n.receiver,receiving_office:n.receiving_office,status:n.status,goods:n.goods,notes:n.notes,return_type:n.return_type,cost_type:n.cost_type,cost:n.cost,goods_type:n.goods_type})).acknowledged}))}delete(e,t){return r(this,void 0,void 0,(function*(){return(yield i.ParcelBaseModel.deleteOne({_id:e,sending_office:t})).acknowledged}))}updateStatus(e,t){return r(this,void 0,void 0,(function*(){return(yield i.ParcelBaseModel.updateOne({_id:e},{status:t.status})).acknowledged}))}getParcels(e){return r(this,void 0,void 0,(function*(){return(yield i.ParcelBaseModel.find({_id:{$in:e}}).exec()).map((e=>{const{_id:t,sender:n,sending_add:r,receiver:i,receiving_add:o,status:a,goods:s,notes:c,sending_office:u,receiving_office:d,creator:l,goods_type:f,cost:p,cost_type:h,return_type:v}=e;return{pid:t.toString(),sender:n,sending_add:r,receiver:i,receiving_add:o,status:a,goods:s,notes:c,goods_type:f,cost:p,cost_type:h,return_type:v,sending_office:u?u.toString():null,receiving_office:d?d.toString():null,creator:l?l.toString():null}}))}))}}},4841:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addressSchema=t.addressLevelSchema=void 0;const r=n(1185);t.addressLevelSchema=new r.Schema({id:{type:String,required:!0},name:{type:String,required:!0}}),t.addressSchema=new r.Schema({country:{type:t.addressLevelSchema,required:!0},province:{type:t.addressLevelSchema,required:!0},district:{type:t.addressLevelSchema,required:!0},commune:{type:t.addressLevelSchema,required:!0},detail:{type:String},lat:{type:Number},long:{type:Number}})},6304:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contactSchema=void 0;const r=n(1185);t.contactSchema=new r.Schema({hotline:{type:String},fax:{type:String},email:{type:String}})},6248:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.customerSchema=void 0;const r=n(1185);t.customerSchema=new r.Schema({name:{type:String,required:!0},phone:{type:String,required:!0}})},5106:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trackingEventSchema=void 0;const r=n(1185),i=n(6820),o=n(9468);t.trackingEventSchema=new r.Schema({name:{type:String,required:!0},responsor:{type:r.Schema.Types.ObjectId,required:!0,ref:i.UserBaseModel},office:{type:r.Schema.Types.ObjectId,required:!0,ref:o.OfficeBaseModel}},{timestamps:!0})},4657:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.goodsSchema=t.EGoodsType=t.EGoodsCategory=void 0;const r=n(1185);var i,o;!function(e){e.ELECTRONICE_DEVICE="electronic devices"}(i||(t.EGoodsCategory=i={})),function(e){e.DOCUMENT="documentation",e.GOODS="goods"}(o||(t.EGoodsType=o={})),t.goodsSchema=new r.Schema({name:{type:String},category:{type:String},quantity:{type:Number},value:{type:Number},weight:{type:Number},attached:{type:String}})},1468:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.officeSchema=t.EOfficeType=void 0;const r=n(1185),i=n(6304);var o;!function(e){e.Gathering="gathering",e.Transaction="transaction",e.Headquarters="headquarters"}(o||(t.EOfficeType=o={})),t.officeSchema=new r.Schema({name:{type:String,required:!0},address:{type:Object,required:!0},manager:{type:r.Schema.Types.ObjectId},contact:{type:i.contactSchema,required:!0},office_type:{type:String,required:!0},gather_office:{type:r.Schema.Types.ObjectId}},{timestamps:!0})},7181:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ECostType=t.EReturnType=t.EParcelStatus=void 0;const i=n(1185),o=n(4841),a=n(6248),s=n(4657),c=n(9468),u=n(6820),d=r(n(3464));var l,f,p;!function(e){e.DELIVERING="delivering",e.DELIVERED="delivered",e.FAILED="failed"}(l||(t.EParcelStatus=l={})),function(e){e.CALL_SENDER="call sender",e.CANCEL="cancel",e.RETURN_NOW="return immediately",e.RETURN_LATER="return later",e.RETURN_OUTDATE="return if out date"}(f||(t.EReturnType=f={})),function(e){e.SENDER_PAY="sender pay",e.RECEIVER_PAY="receiver pay"}(p||(t.ECostType=p={}));const h=new i.Schema({creator:{type:i.Schema.Types.ObjectId,required:!0,ref:u.UserBaseModel},sender:{type:a.customerSchema,required:!0},sending_add:{type:o.addressSchema,required:!0},sending_office:{type:i.Schema.Types.ObjectId,require:!0,ref:c.OfficeBaseModel},receiver:{type:a.customerSchema,required:!0},receiving_add:{type:o.addressSchema,required:!0},receiving_office:{type:i.Schema.Types.ObjectId,require:!0,ref:c.OfficeBaseModel},status:{type:String,required:!0},goods:{type:[s.goodsSchema],required:!0},goods_type:{type:String,required:!0},return_type:{type:String,required:!0},cost:{type:Number,required:!0},cost_type:{type:String,required:!0},notes:{type:String}},{timestamps:!0});h.plugin(d.default),t.default=h},9372:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.setTokenIndex=t.schema=void 0;const i=n(9818),o=n(7773);t.schema={"$.token":{type:o.SchemaFieldTypes.TEXT,AS:"token"},"$.uid":{type:o.SchemaFieldTypes.TEXT,AS:"uid"}},t.setTokenIndex=function(){return r(this,void 0,void 0,(function*(){try{yield i.redis.ft.create("idx:token",t.schema,{ON:"JSON",PREFIX:"token_"})}catch(e){"Index already exists"===e.message?console.log("Index idx:token exists already, skipped creation."):console.error(e)}}))}},9716:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trackingSchema=void 0;const r=n(1185),i=n(9656),o=n(5106);t.trackingSchema=new r.Schema({parcel:{type:r.Schema.Types.ObjectId,required:!0,ref:i.ParcelBaseModel},events:{type:[o.trackingEventSchema]}},{timestamps:!0})},5102:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.userSchema=void 0;const r=n(1185),i=n(9468);t.userSchema=new r.Schema({username:{type:String,required:!0,unique:!0,index:!0},password:{type:String,required:!0},role:{type:String,required:!0},version:{type:Number,required:!0},email:{type:String,unique:!0,index:!0},phone:{type:String,unique:!0,index:!0},name:{type:String},office:{type:r.Schema.Types.ObjectId,ref:i.OfficeBaseModel}},{timestamps:!0})},4947:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(9818),o=n(4816);t.default=new class{insertRefreshToken(e,t,n){return r(this,void 0,void 0,(function*(){if(yield i.redis.set((0,o.getKey)(t,o.NameType.USER_VERSION),0,{NX:!0}),"OK"!==(yield i.redis.json.set((0,o.getKey)(e,o.NameType.TOKEN),"$",{uid:t,token:e}))||"OK"!==(yield i.redis.set((0,o.getKey)(t,o.NameType.USER_ROLE),n)))throw new Error("Unable to add refresh token")}))}getRefreshToken(e){return r(this,void 0,void 0,(function*(){return yield i.redis.json.get((0,o.getKey)(e,o.NameType.TOKEN))}))}deleteRefreshToken(e){return r(this,void 0,void 0,(function*(){const t=yield i.redis.ft.search("idx:token",`@uid:"${e}"`);t&&(yield Promise.all(t.documents.map((e=>i.redis.json.del(e.id)))))}))}updateVersion(e){return r(this,void 0,void 0,(function*(){if(!i.redis.incr((0,o.getKey)(e,o.NameType.USER_VERSION)))throw new Error("Unable to update version")}))}getVersion(e){return r(this,void 0,void 0,(function*(){return yield i.redis.get((0,o.getKey)(e,o.NameType.USER_VERSION))}))}getRole(e){return r(this,void 0,void 0,(function*(){return yield i.redis.get((0,o.getKey)(e,o.NameType.USER_ROLE))}))}}},1066:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=i(n(1185)),a=n(6899);t.default=new class{create(e){return r(this,void 0,void 0,(function*(){return(yield a.TrackingBaseModel.create({parcel:e.parcel,events:[{office:e.office,name:"Created parcel",responsor:e.uid}]}))._id}))}push(e,t){return r(this,void 0,void 0,(function*(){return(yield a.TrackingBaseModel.updateOne({parcel:e},{$push:{events:{responsor:t.uid,name:t.name,office:t.office}}})).acknowledged}))}getByParcelID(e){return r(this,void 0,void 0,(function*(){return(yield a.TrackingBaseModel.find({parcel:new o.default.Types.ObjectId(e)},{parcel:1,events:1,_id:1}).exec()).map((e=>{const{_id:t,parcel:n,events:r}=e;return{tid:t.toString(),parcel:n.toString(),events:r.map((e=>({name:e.name,responsor:e.responsor.toString(),office:e.office.toString()})))}}))}))}}},5805:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6820);t.default=new class{getUsers(e){return r(this,void 0,void 0,(function*(){return(yield i.UserBaseModel.find({_id:{$in:e}},{role:1,email:1,username:1,phone:1,_id:1,name:1,office:1}).exec()).map((e=>{const{_id:t,email:n,username:r,phone:i,name:o,role:a,office:s}=e;return{uid:t.toString(),email:n,username:r,phone:i,name:o,role:a,office:s}}))}))}}},8479:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(8513),o=r(n(8961)),a=r(n(6950));t.default=function(e){e.use("/v1",o.default),e.all("/v1/graphql",(0,i.createHandler)({schema:a.default}))}},9413:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(6464)),a=n(322),s=n(6990),c=i.default.Router();c.post("/login",o.default.login),c.post("/logout",[a.checkJWT],o.default.logout),c.post("/reset",o.default.requestReset),c.get("/reset",[s.checkReset],o.default.verifyReset),c.put("/reset",[s.checkReset],o.default.resetPassword),t.default=c},8961:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6860),o=r(n(9690)),a=r(n(9413)),s=r(n(6725)),c=r(n(8558)),u=(0,i.Router)();u.use("/",o.default),u.use("/auth",a.default),u.use("/office",s.default),u.use("/parcel",c.default),t.default=u},6725:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(3639)),o=n(322),a=n(944),s=r(n(6860)).default.Router();s.post("/",[o.checkJWT,a.checkRole.bind({role:["dob","admin"]})],i.default.create),s.delete("/:id",[o.checkJWT,a.checkRole.bind({role:["dob","admin"]})],i.default.delete),s.put("/:id",[o.checkJWT,a.checkRole.bind({role:["dob","admin"]})],i.default.update),t.default=s},8558:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(314)),o=n(322),a=n(944),s=r(n(6860)).default.Router();s.post("/",[o.checkJWT,a.checkRole.bind({role:["gathe_staf","admin"]})],i.default.create),s.delete("/:id",[o.checkJWT,a.checkRole.bind({role:["gathe_staf","admin"]})],i.default.delete),s.put("/:id",[o.checkJWT,a.checkRole.bind({role:["gathe_staf","admin"]})],i.default.update),s.post("/:id",[o.checkJWT,a.checkRole.bind({role:["trans_staf","admin"]})],i.default.updateStatus),t.default=s},9690:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6860)),o=r(n(6305)),a=i.default.Router();a.get("/",o.default.getStatus),a.post("/user",o.default.getUser),a.post("/token",o.default.addToken),t.default=a},6950:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(7343),i=n(2453),o=n(1504),a=n(8819),s=n(9038),c=new r.GraphQLObjectType({name:"Query",description:"Root Query",fields:()=>({parcels:o.parcelsQuery,users:a.userQuery,offices:i.officeQuery,tracking:s.trackingQuery})});t.default=new r.GraphQLSchema({query:c})},2453:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.officeQuery=void 0;const o=n(7343),a=n(1540),s=i(n(7515));t.officeQuery={type:(0,o.GraphQLList)(a.OfficeGraph),description:"OfficeQuery",args:{poids:{type:(0,o.GraphQLNonNull)((0,o.GraphQLList)(o.GraphQLString))}},resolve:(e,t)=>r(void 0,void 0,void 0,(function*(){return t.poids&&Array.isArray(t.poids)?yield s.default.getOffices(t.poids):[]}))}},1504:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parcelsQuery=void 0;const o=i(n(2523)),a=n(7343),s=n(6329);t.parcelsQuery={type:(0,a.GraphQLList)(s.ParcelGraph),description:"Parcel Query",args:{pids:{type:(0,a.GraphQLNonNull)((0,a.GraphQLList)(a.GraphQLString))}},resolve:(e,t)=>r(void 0,void 0,void 0,(function*(){return t.pids&&Array.isArray(t.pids)?yield o.default.getParcels(t.pids):[]}))}},9038:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.trackingQuery=void 0;const o=n(7343),a=n(236),s=i(n(1066));t.trackingQuery={type:(0,o.GraphQLList)(a.TrackingGraph),args:{pid:{type:o.GraphQLString}},resolve:(e,t)=>r(void 0,void 0,void 0,(function*(){return t.pid?yield s.default.getByParcelID(t.pid):null}))}},8819:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.userQuery=void 0;const o=n(7343),a=n(6797),s=i(n(5805));t.userQuery={type:(0,o.GraphQLList)(a.UserGraph),description:"User Query",args:{uids:{type:(0,o.GraphQLNonNull)((0,o.GraphQLList)(o.GraphQLString))}},resolve:(e,t)=>r(void 0,void 0,void 0,(function*(){return t.uids&&Array.isArray(t.uids)?yield s.default.getUsers(t.uids):[]}))}},6536:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddressGraph=t.AddressLevelGraph=void 0;const r=n(7343);t.AddressLevelGraph=new r.GraphQLObjectType({name:"AddressLevelGraph",description:"Address Level Graph",fields:{id:{type:r.GraphQLString},name:{type:r.GraphQLString}}}),t.AddressGraph=new r.GraphQLObjectType({name:"AddressGraph",description:"Address Graph",fields:{country:{type:t.AddressLevelGraph},province:{type:t.AddressLevelGraph},district:{type:t.AddressLevelGraph},commune:{type:t.AddressLevelGraph},detail:{type:r.GraphQLString},lat:{type:r.GraphQLFloat},long:{type:r.GraphQLFloat}}})},152:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContactGraph=void 0;const r=n(7343);t.ContactGraph=new r.GraphQLObjectType({name:"ContactGraph",description:"Contact Graph",fields:{hotline:{type:r.GraphQLString},fax:{type:r.GraphQLString},email:{type:r.GraphQLString}}})},7669:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomerGraph=void 0;const r=n(7343);t.CustomerGraph=new r.GraphQLObjectType({name:"CustomerGraph",description:"Customer Graph",fields:{name:{type:r.GraphQLString},phone:{type:r.GraphQLString}}})},4824:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackingEventGraph=void 0;const o=n(7343),a=n(6797),s=n(1540),c=i(n(5805)),u=i(n(7515));t.TrackingEventGraph=new o.GraphQLObjectType({name:"TrackingEventGraph",description:"Tracking Event Graph",fields:{name:{type:o.GraphQLString},responsor:{type:(0,o.GraphQLList)(a.UserGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return yield c.default.getUsers([e.responsor.toString()])}))},office:{type:(0,o.GraphQLList)(s.OfficeGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return yield u.default.getOffices([e.office])}))}}})},1697:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GoodsGraph=t.GoodsCategoryEnum=t.GoodsTypeEnum=void 0;const i=n(7343),o=n(4657),a=r(n(8333));t.GoodsTypeEnum=new i.GraphQLEnumType({name:"GoodsTypeEnum",description:"Goods Type Enum",values:(0,a.default)(o.EGoodsType)}),t.GoodsCategoryEnum=new i.GraphQLEnumType({name:"GoodsCategoryEnum",description:"Goods Category Enum",values:(0,a.default)(o.EGoodsCategory)}),t.GoodsGraph=new i.GraphQLObjectType({name:"GoodsGraph",description:"Goods Graph",fields:{name:{type:i.GraphQLString},category:{type:t.GoodsCategoryEnum},quantity:{type:i.GraphQLInt},value:{type:i.GraphQLInt},weight:{type:i.GraphQLInt},attached:{type:i.GraphQLString}}})},1540:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OfficeTypeEnum=t.OfficeGraph=void 0;const o=n(7343),a=n(1468),s=n(6536),c=n(152),u=n(6797),d=i(n(7515)),l=i(n(5805)),f=i(n(8333)),p=new o.GraphQLEnumType({name:"OfficeTypeEnum",description:"Office Type Enum",values:(0,f.default)(a.EOfficeType)});t.OfficeTypeEnum=p;const h=new o.GraphQLObjectType({name:"OfficeGraph",description:"Office Graph",fields:()=>({poid:{type:o.GraphQLString},name:{type:o.GraphQLString},address:{type:s.AddressGraph},contact:{type:c.ContactGraph},office_type:{type:p},manager:{type:(0,o.GraphQLList)(u.UserGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.manager?yield l.default.getUsers([e.manager]):null}))},gather_office:{type:(0,o.GraphQLList)(h),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.gather_office?yield d.default.getOffices([e.gather_office]):null}))}})});t.OfficeGraph=h},6329:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ParcelGraph=void 0;const o=n(7343),a=n(6536),s=n(7669),c=n(1697),u=n(7181),d=n(1540),l=n(6797),f=i(n(7515)),p=i(n(5805)),h=i(n(8333)),v=new o.GraphQLEnumType({name:"ParcelStatusEnum",description:"Parcel Status Enum",values:(0,h.default)(u.EParcelStatus)}),y=new o.GraphQLEnumType({name:"ReturnTypeEnum",description:"Return Type Enum",values:(0,h.default)(u.EReturnType)}),_=new o.GraphQLEnumType({name:"CostTypeEnum",description:"Cost Type Enum",values:(0,h.default)(u.ECostType)});t.ParcelGraph=new o.GraphQLObjectType({name:"ParcelGraph",description:"Parcel Graph",fields:{pid:{type:o.GraphQLString},sender:{type:s.CustomerGraph},sending_add:{type:a.AddressGraph},receiver:{type:s.CustomerGraph},receiving_add:{type:a.AddressGraph},status:{type:v},goods:{type:(0,o.GraphQLList)(c.GoodsGraph)},notes:{type:o.GraphQLString},goods_type:{type:c.GoodsTypeEnum},return_type:{type:y},cost:{type:o.GraphQLInt},cost_type:{type:_},creator:{type:(0,o.GraphQLList)(l.UserGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.creator?yield p.default.getUsers([e.creator]):null}))},sending_office:{type:(0,o.GraphQLList)(d.OfficeGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.sending_office?yield f.default.getOffices([e.sending_office]):null}))},receiving_office:{type:(0,o.GraphQLList)(d.OfficeGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.receiving_office?yield f.default.getOffices([e.receiving_office]):null}))}}})},236:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TrackingGraph=void 0;const o=n(7343),a=n(6329),s=n(4824),c=i(n(2523));t.TrackingGraph=new o.GraphQLObjectType({name:"TrackingGraph",description:"Tracking Graph",fields:{tid:{type:o.GraphQLString},parcel:{type:(0,o.GraphQLList)(a.ParcelGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return yield c.default.getParcels([e.parcel])}))},events:{type:(0,o.GraphQLList)(s.TrackingEventGraph)}}})},6797:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserGraph=t.UserTypeEnum=void 0;const o=n(2790),a=i(n(8333)),s=n(7343),c=n(1540),u=i(n(7515));t.UserTypeEnum=new s.GraphQLEnumType({name:"UserTypeEnum",description:"User Type Enum",values:(0,a.default)(o.EUserRole)}),t.UserGraph=new s.GraphQLObjectType({name:"UserGraph",description:"User Graph",fields:()=>({uid:{type:s.GraphQLString},name:{type:s.GraphQLString},role:{type:t.UserTypeEnum},office:{type:(0,s.GraphQLList)(c.OfficeGraph),resolve:e=>r(void 0,void 0,void 0,(function*(){return e.office?yield u.default.getOffices([e.office]):null}))}})})},2790:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EUserRole=void 0,function(e){e.ADMIN="admin",e.BOD="bod",e.HEAD="head",e.TRANS_STAF="trans_staf",e.GATHE_STAF="gathe_staf"}(n||(t.EUserRole=n={}))},5417:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputError=void 0;class n extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,n.prototype),this.field=t}}t.InputError=n},7797:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateResetToken=t.generateToken=t.generate_uid=void 0;const o=n(9344),a=i(n(5343)),s=n(1633);t.generate_uid=function(e=8){return e=e>0?e:8,[...new Array(e)].map((()=>(0,9,Math.floor(9*Math.random())+0).toString())).join("")},t.generateToken=function(e,t){const n=e,{iat:i,exp:c}=n,u=r(n,["iat","exp"]);return{accessToken:(0,o.sign)(u,a.default.JWT_KEY,s.JWTTokenOpt),refreshToken:t&&(0,o.sign)(u,a.default.JWT_REFRESH_KEY,s.JWTRefreshOpt)}},t.generateResetToken=function(e){const t=e,{iat:n,exp:i}=t,c=r(t,["iat","exp"]);return(0,o.sign)(c,a.default.JWT_RESET_KEY,s.JWTResetOpt)}},8849:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5417);t.default=function(e,t){return r(this,void 0,void 0,(function*(){try{yield t()}catch(t){console.log(t),t instanceof i.InputError?e.status(400).json({message:t.message,name:t.field}):e.sendStatus(500)}}))}},4816:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getKey=t.NameType=void 0,function(e){e[e.USER_VERSION=0]="USER_VERSION",e[e.USER_ROLE=1]="USER_ROLE",e[e.TOKEN=2]="TOKEN"}(n||(t.NameType=n={})),t.getKey=function(e,t){return t===n.USER_VERSION&&e+"_v"||t===n.USER_ROLE&&e+"_r"||t===n.TOKEN&&"token_"+e||e}},6203:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveAddress=void 0;const r=n(5771);t.resolveAddress=function(e){if(e){const t=(0,r.findLevel1ById)(e.province),n={id:t.id,name:t.name},i=t.findLevel2ById(e.district),o={id:i.id,name:i.name},a=i.findLevel3ById(e.commune);return{country:{name:"Việt Nam",id:"vi"},province:n,district:o,commune:{id:a.id,name:a.name},detail:e.detail}}}},3713:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startup=t.sendForgetPasswordMail=t.sendMail=t.renderTemplate=void 0;const c=s(n(6168)),u=s(n(5343)),d=o(n(2097)),l=o(n(7147)),f=o(n(1017));function p(e,t,n){return a(this,void 0,void 0,(function*(){yield c.default.sendMail({from:`"${u.default.APP_NAME}" <${u.default.MAIL_USER}>`,to:e,subject:t,html:n})}))}t.renderTemplate=(e,t)=>{const n=f.join(f.resolve(),e),r=l.readFileSync(n,"utf-8").toString();return d.compile(r)(t)},t.sendMail=p,t.sendForgetPasswordMail=function(e,n){return a(this,void 0,void 0,(function*(){const r="dev"===u.default.ENV?"/src/templates/forgot-password-email.html":"/templates/forgot-password-email",i=(0,t.renderTemplate)(r,{url:`${u.default.BACKEND}/auth/reset?token=${n}`,name:e.username});return yield p(e.email,"Khôi phục mật khẩu trên "+u.default.APP_NAME,i)}))},t.startup=function(){return a(this,void 0,void 0,(function*(){return yield p("fakenoname02@gmail.com","Server started","Server started now")}))}},8333:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return Object.fromEntries(Object.entries(e).map((([e,t],n)=>[e,{value:t}])))}},4747:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5417);class i{static validateUsername(e){if(!e||e.length<3||e.length>50)throw new r.InputError("Username có độ dài từ 3 đến 50 ký tự","username");return!0}static validatePassword(e){if(!e||e.length<8||e.length>50)throw new r.InputError("Mật khẩu có độ dài từ 8 đến 50 ký tự","password");return!0}static validateEmail(e){if(!e||!/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(e))throw new r.InputError("Email không hợp lệ","email");return!0}static validateRePassword(e,t){if(t!=e)throw new r.InputError("Mật khẩu nhập lại cần giống mật khẩu","re_password")}static validateLoginPassword(e){i.validateUsername(e.username),i.validatePassword(e.password)}static validateRequestReset(e){e.username&&i.validateUsername(e.username)||i.validateEmail(e.email)}static validateReset(e){i.validatePassword(e.password),i.validateRePassword(e.password,e.re_password)}}t.default=i},3389:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(5417),i=n(5771);t.default=class{static checkId(e,t){if(e){if(24!=e.length)throw new r.InputError("Invalid id","id")}else if(!t)throw new r.InputError("Must include id","id")}static checkPid(e,t){if(e){if(10!=e.length)throw new r.InputError("Invalid id","id")}else if(!t)throw new r.InputError("Must include id","id")}static checkCustomer(e,t){if(e){if(!e.name||0===e.name.trim().length)throw new r.InputError("Customer must include name","customer.name");if(!e.phone||10!==e.phone.trim().length)throw new r.InputError("Customer must include phone or given phone is invalid","customer.phone")}else if(!t)throw new r.InputError("Must include customer","customer")}static checkAddress(e,t){if(e){if(!e.country)throw new r.InputError("Address must included country code","address.country");if(!e.province)throw new r.InputError("Address must include province code","address.province");if(!e.district)throw new r.InputError("Address must included district code","address.district");if(!e.commune)throw new r.InputError("Address must included commune code","address.commune");const t=(0,i.findLevel1ById)(e.province);if(!t)throw new r.InputError("Invalid province id","address.province");const n=t.findLevel2ById(e.district);if(!n)throw new r.InputError("Invalid district id","address.district");if(!n.findLevel3ById(e.commune))throw new r.InputError("Invalid commune id","address.commune")}else if(!t)throw new r.InputError("Must included address","address")}static checkContact(e,t){if(e){if(!e.email)throw new r.InputError("Contact must include contact email","contact.email");if(!e.fax)throw new r.InputError("Contact must include contact fax","contact.fax");if(!e.hotline)throw new r.InputError("Contact must include contact hotline","contact.hotline")}else if(!t)throw new r.InputError("Must include contact","contact")}}},2332:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5417),o=n(1468),a=r(n(3389));class s extends a.default{static checkName(e,t){if(e);else if(!t)throw new i.InputError("Must included office's name","name")}static checkType(e,t){if(e){if(!Object.values(o.EOfficeType).includes(e))throw new i.InputError("Invalid office's type","office_type")}else if(!t)throw new i.InputError("Must included office's type","office_type")}static validateCreate(e){this.checkName(e.name),this.checkAddress(e.address),this.checkContact(e.contact),this.checkType(e.office_type),this.checkId(e.gather_office,!0),this.checkId(e.manager,!0)}static validateDelete(e){this.checkId(e.id)}static validateUpdate(e){this.checkId(e.id,!0),this.checkName(e.name,!0),this.checkId(e.gather_office,!0),this.checkId(e.manager,!0),this.checkAddress(e.address,!0),this.checkContact(e.contact,!0),this.checkType(e.office_type,!0)}}t.default=s},2750:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(5417),o=r(n(3389)),a=n(7181),s=n(4657),c=n(4657);class u extends o.default{static checkStatus(e,t){if(e){if(!Object.values(a.EParcelStatus).includes(e))throw new i.InputError("Invalid parcel's status","status")}else if(!t)throw new i.InputError("Must included parcel's status","status")}static checkGoodsType(e,t){if(e){if(!Object.values(s.EGoodsType).includes(e))throw new i.InputError("Invalid parcel's goods type","goods_type")}else if(!t)throw new i.InputError("Must included parcel's goods type","goods_type")}static checkReturnType(e,t){if(e){if(!Object.values(a.EReturnType).includes(e))throw new i.InputError("Invalid parcel's return type","return_type")}else if(!t)throw new i.InputError("Must included parcel's return type","return_type")}static checkCostType(e,t){if(e){if(!Object.values(a.ECostType).includes(e))throw new i.InputError("Invalid parcel's cost type","cost_type")}else if(!t)throw new i.InputError("Must included parcel's cost type","cost_type")}static checkGoods(e,t){if(e){if(!Array.isArray(e))throw new i.InputError("Goods must be an array","goods");if(e.some((e=>!(e.weight&&e.value&&e.category&&e.quantity&&e.name))))throw new i.InputError("Goods must include value, weight, category, quantity and name","goods");if(e.some((e=>!Object.values(c.EGoodsCategory).includes(e.category))))throw new i.InputError("Invalid category good type","goods.category")}else if(!t)throw new i.InputError("Must included parcel's goods","goods")}static checkName(e,t){if(e){if(0===e.trim().length)throw new i.InputError("Invalid name","name")}else if(!t)throw new i.InputError("Must include name","name")}static checkCost(e,t){if(e){if(e<0)throw new i.InputError("Invalid cost","cost")}else if(!t)throw new i.InputError("Must include cost","cost")}static validateCreate(e){this.checkCustomer(e.sender),this.checkCustomer(e.receiver),this.checkAddress(e.receiving_add),this.checkAddress(e.sending_add),this.checkId(e.receiving_office,!0),this.checkStatus(e.status),this.checkGoods(e.goods),this.checkGoodsType(e.goods_type),this.checkReturnType(e.return_type),this.checkCostType(e.cost_type),this.checkCost(e.cost)}static validateDelete(e){this.checkId(e.id)}static validateUpdate(e){this.checkId(e.id),this.checkCustomer(e.sender,!0),this.checkCustomer(e.receiver,!0),this.checkAddress(e.receiving_add,!0),this.checkAddress(e.sending_add,!0),this.checkId(e.receiving_office,!0),this.checkStatus(e.status,!0),this.checkGoods(e.goods,!0),this.checkGoodsType(e.goods_type,!0),this.checkReturnType(e.return_type,!0),this.checkCostType(e.cost_type,!0),this.checkCost(e.cost,!0)}static validateUpdateStatus(e){this.checkId(e.id),this.checkStatus(e.status),this.checkName(e.name)}}t.default=u},8432:e=>{e.exports=require("bcryptjs")},9710:e=>{e.exports=require("cookie-parser")},3582:e=>{e.exports=require("cors")},5142:e=>{e.exports=require("dotenv")},5771:e=>{e.exports=require("dvhcvn")},6860:e=>{e.exports=require("express")},7343:e=>{e.exports=require("graphql")},8513:e=>{e.exports=require("graphql-http/lib/use/express")},2097:e=>{e.exports=require("handlebars")},7806:e=>{e.exports=require("helmet")},9344:e=>{e.exports=require("jsonwebtoken")},3464:e=>{e.exports=require("mongoosastic")},1185:e=>{e.exports=require("mongoose")},9470:e=>{e.exports=require("morgan")},5184:e=>{e.exports=require("nodemailer")},7773:e=>{e.exports=require("redis")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.c=t,n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n(n.s=3607)})();